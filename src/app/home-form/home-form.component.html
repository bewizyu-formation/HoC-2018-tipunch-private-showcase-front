<section>
    <form class="form-container" (ngSubmit)="register()" [formGroup]="userForm">
        <h3 class="form-title">{{formTitle}}</h3>

        <mat-form-field >
            <input matInput placeholder="Nom d'utilsateur" formControlName="username">
            <mat-error *ngFor="let validation of subscribe_validation_messages.username">
                <mat-error class="error-message"
                           *ngIf="userForm.get('username').hasError(validation.type)
                           && (userForm.get('username').dirty
                           || userForm.get('username').touched)">{{validation.message}}</mat-error>
            </mat-error>
        </mat-form-field>

        <mat-form-field>
            <input matInput
                   type="email"
                   name="email"
                   placeholder="votre email : monemail@servermail.extension"
                   formControlName="email">
            <mat-error *ngFor="let validation of subscribe_validation_messages.email">
                <mat-error class="error-message" *ngIf="userForm.get('email').hasError(validation.type) && (userForm.get('email').dirty || userForm.get('email').touched)">{{validation.message}}
                </mat-error>
            </mat-error>
        </mat-form-field>

        <div formGroupName="passForm">
            <mat-form-field class="full-width">
                <input matInput
                       [type]="hide ? 'password' : 'text'"
                       placeholder="Password" formControlName="password"  [errorStateMatcher]="parentErrorStateMatcher" >
                <mat-icon matSuffix (click)="hide = !hide">{{hide ? 'visibility' : 'visibility_off'}}</mat-icon>
                <mat-error *ngFor="let validation of subscribe_validation_messages.password">
                    <mat-error class="error-message" *ngIf="userForm.get('passForm').get('password').hasError(validation.type) && (userForm.get('passForm').get('password').dirty || userForm.get('passForm').get('password').touched)">{{validation.message}}</mat-error>
                </mat-error>
            </mat-form-field>

            <mat-form-field class="full-width">
                <input matInput
                       [type]="hide ? 'password' : 'text'"
                       placeholder="Confirm Password" formControlName="passwordConfirm"  [errorStateMatcher]="parentErrorStateMatcher">
                <mat-icon matSuffix (click)="hide = !hide">{{hide ? 'visibility' : 'visibility_off'}}</mat-icon>

                <mat-error *ngFor="let validation of subscribe_validation_messages.passwordConfirm">
                    <mat-error class="error-message" *ngIf="(userForm.get('passForm').get('passwordConfirm').hasError(validation.type)|| userForm.get('passForm').hasError(validation.type)) && (userForm.get('passForm').get('passwordConfirm').dirty || userForm.get('passForm').get('passwordConfirm').touched)">{{validation.message}}</mat-error>
                </mat-error>
            </mat-form-field>
        </div>
        <mat-form-field>
            <input matInput
                   type="text"
                   name="commune"
                   placeholder="commune"
                   [matAutocomplete]="auto"
                   formControlName="cityName"
            >
            <mat-autocomplete #auto="matAutocomplete">
                <mat-option *ngFor="let commune of cities" name="commune" [value]="commune?.nom +' '+ commune?.codesPostaux[0]">
                    {{commune?.nom}}
                    {{commune?.codesPostaux[0]}}
                </mat-option>
            </mat-autocomplete>
            <mat-error *ngFor="let validation of subscribe_validation_messages.cityName">
                <mat-error *ngIf="userForm.get('cityName').hasError(validation.type) && userForm.get('cityName').dirty || userForm.get('cityName').touched">
                </mat-error>
            </mat-error>
        </mat-form-field>

        <mat-checkbox
                data-md-icheck
                type="checkbox"
                name="isartist"
                formControlName="isArtist">
            <span>Vous Ãªtes artistes / groupes</span>
        </mat-checkbox>

        <div formGroupName="artistForm" *ngIf="userForm.get('isArtist').value">
            <mat-form-field >
                <input matInput placeholder="Nom d'artiste" formControlName="artistName" [errorStateMatcher]="parentErrorStateMatcher" >

                <mat-error *ngFor="let validation of subscribe_validation_messages.artistName">
                    <mat-error class="error-message" *ngIf="
                  userForm.get('artistForm').get('artistName').hasError(validation.type) && (userForm.get('artistForm').get('artistName').dirty || userForm.get('artistForm').get('artistName').touched)">{{validation.message}}</mat-error>
                </mat-error>
            </mat-form-field>

            <mat-form-field>
                 <textarea matInput class="form-long-description" formControlName="artistShortDesc" placeholder="Votre description" name="shortDesc" [errorStateMatcher]="parentErrorStateMatcher">
                 </textarea>

                <mat-error *ngFor="let validation of subscribe_validation_messages.artistShortDesc">
                    <mat-error class="error-message" *ngIf="userForm.get('artistForm').get('artistShortDesc').hasError(validation.type) && (userForm.get('artistForm').get('artistShortDesc').dirty || userForm.get('artistForm').get('artistShortDesc').touched)">{{validation.message}}</mat-error>
                </mat-error>
            </mat-form-field>
        </div>

        <div class="confirm-container">
            <button mat-button class="cancel"
                    (click)="reset()">Annuler</button>
            <button mat-button class="confirm"
                    type="submit"
            >Valider</button>
        </div>
    </form>
</section>